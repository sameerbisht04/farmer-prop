<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Crop Advisor - Fully Working Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .typing-indicator {
            display: inline-block;
        }
        .typing-indicator span {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #9CA3AF;
            margin: 0 2px;
            animation: typing 1.4s infinite ease-in-out;
        }
        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }
        .message-animation {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .pulse-green {
            animation: pulse-green 2s infinite;
        }
        @keyframes pulse-green {
            0%, 100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
            50% { box-shadow: 0 0 0 10px rgba(34, 197, 94, 0); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-green-50 to-blue-50 min-h-screen">
    <div class="container mx-auto p-4">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900 mb-4">
                ü§ñ AI Crop Advisor - Fully Working Demo
            </h1>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                Interactive AI chatbot for farmers with multilingual support (Hindi, English, Punjabi)
            </p>
            <div class="mt-4 flex justify-center space-x-4">
                <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">‚úÖ Working</span>
                <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">üåê Multilingual</span>
                <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm">üé§ Voice Ready</span>
            </div>
        </div>

        <div class="max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Chat Interface -->
            <div class="lg:col-span-2">
                <div class="bg-white rounded-lg shadow-lg border border-gray-200">
                    <!-- Header -->
                    <div class="p-4 border-b border-gray-200 bg-green-50">
                        <div class="flex items-center justify-between">
                            <div>
                                <h2 class="text-xl font-semibold text-gray-900">üåæ AI Crop Advisor</h2>
                                <p class="text-sm text-gray-600">Ask questions about farming, crops, and agriculture</p>
                            </div>
                            <div class="flex items-center space-x-2">
                                <select id="languageSelect" class="px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-green-500">
                                    <option value="hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</option>
                                    <option value="en">English</option>
                                    <option value="pa">‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä</option>
                                </select>
                                <div class="w-3 h-3 bg-green-500 rounded-full pulse-green"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quick Questions -->
                    <div class="p-4 border-b border-gray-200 bg-gray-50">
                        <h3 class="text-sm font-medium text-gray-700 mb-2">Quick Questions:</h3>
                        <div class="flex flex-wrap gap-2" id="quickQuestions">
                            <!-- Quick questions will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Messages -->
                    <div id="messagesContainer" class="h-96 overflow-y-auto p-4 space-y-4">
                        <div class="flex justify-start">
                            <div class="max-w-xs lg:max-w-md px-4 py-2 rounded-lg bg-gray-100 text-gray-900 message-animation">
                                <p class="text-sm">‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡§æ AI ‡§ï‡•É‡§∑‡§ø ‡§∏‡§≤‡§æ‡§π‡§ï‡§æ‡§∞ ‡§π‡•Ç‡§Ç‡•§ ‡§Ü‡§ú ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡•ç‡§Ø‡§æ ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç? (Hello! I am your AI agriculture advisor. How can I help you today?)</p>
                                <p class="text-xs mt-1 text-gray-500" id="initialTime"></p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Input Form -->
                    <div class="p-4 border-t border-gray-200">
                        <div class="flex space-x-2">
                            <input
                                type="text"
                                id="messageInput"
                                placeholder="‡§Ö‡§™‡§®‡§æ ‡§∏‡§µ‡§æ‡§≤ ‡§Ø‡§π‡§æ‡§Å ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç..."
                                class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500"
                            />
                            <button
                                type="button"
                                id="voiceButton"
                                class="px-3 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors"
                                title="Start voice input"
                            >
                                üé§
                            </button>
                            <button
                                type="button"
                                id="sendButton"
                                class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500"
                            >
                                Send
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Features Panel -->
            <div class="space-y-6">
                <!-- Features -->
                <div class="bg-white rounded-lg shadow-lg border border-gray-200 p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">‚ú® Features</h3>
                    <div class="space-y-3">
                        <div class="flex items-center space-x-3">
                            <span class="text-2xl">üåê</span>
                            <div>
                                <p class="font-medium text-gray-900">Multilingual</p>
                                <p class="text-sm text-gray-600">Hindi, English, Punjabi</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3">
                            <span class="text-2xl">üé§</span>
                            <div>
                                <p class="font-medium text-gray-900">Voice Input</p>
                                <p class="text-sm text-gray-600">Speech recognition</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3">
                            <span class="text-2xl">ü§ñ</span>
                            <div>
                                <p class="font-medium text-gray-900">AI-Powered</p>
                                <p class="text-sm text-gray-600">Smart responses</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3">
                            <span class="text-2xl">üåæ</span>
                            <div>
                                <p class="font-medium text-gray-900">Crop Advice</p>
                                <p class="text-sm text-gray-600">Expert guidance</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sample Questions -->
                <div class="bg-white rounded-lg shadow-lg border border-gray-200 p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">üí° Try These Questions</h3>
                    <div class="space-y-2">
                        <button class="w-full text-left p-2 bg-green-50 hover:bg-green-100 rounded-md text-sm transition-colors" onclick="askQuestion('‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à ‡§ï‡§¨ ‡§ï‡§∞‡•á‡§Ç?')">
                            ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à ‡§ï‡§¨ ‡§ï‡§∞‡•á‡§Ç?
                        </button>
                        <button class="w-full text-left p-2 bg-green-50 hover:bg-green-100 rounded-md text-sm transition-colors" onclick="askQuestion('‡§ï‡•Ä‡§ü ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£ ‡§ï‡•à‡§∏‡•á ‡§ï‡§∞‡•á‡§Ç?')">
                            ‡§ï‡•Ä‡§ü ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£ ‡§ï‡•à‡§∏‡•á ‡§ï‡§∞‡•á‡§Ç?
                        </button>
                        <button class="w-full text-left p-2 bg-green-50 hover:bg-green-100 rounded-md text-sm transition-colors" onclick="askQuestion('‡§ñ‡§æ‡§¶ ‡§ï‡§¨ ‡§°‡§æ‡§≤‡•á‡§Ç?')">
                            ‡§ñ‡§æ‡§¶ ‡§ï‡§¨ ‡§°‡§æ‡§≤‡•á‡§Ç?
                        </button>
                        <button class="w-full text-left p-2 bg-green-50 hover:bg-green-100 rounded-md text-sm transition-colors" onclick="askQuestion('‡§Æ‡•å‡§∏‡§Æ ‡§ï‡•à‡§∏‡§æ ‡§π‡•à?')">
                            ‡§Æ‡•å‡§∏‡§Æ ‡§ï‡•à‡§∏‡§æ ‡§π‡•à?
                        </button>
                    </div>
                </div>

                <!-- Status -->
                <div class="bg-white rounded-lg shadow-lg border border-gray-200 p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">üìä Status</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">AI Status</span>
                            <span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">Online</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Language</span>
                            <span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs" id="currentLang">Hindi</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Messages</span>
                            <span class="px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs" id="messageCount">1</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- API Test Section -->
        <div class="mt-8 max-w-4xl mx-auto">
            <div class="bg-white rounded-lg shadow-lg border border-gray-200 p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">üîß API Test</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Test Message</label>
                        <input type="text" id="apiTestInput" placeholder="Enter test message" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Language</label>
                        <select id="apiTestLang" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                            <option value="hi">Hindi</option>
                            <option value="en">English</option>
                            <option value="pa">Punjabi</option>
                        </select>
                    </div>
                </div>
                <button onclick="testAPI()" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors">
                    Test API Call
                </button>
                <div id="apiResponse" class="mt-4 p-3 bg-gray-50 rounded-md hidden">
                    <h4 class="font-medium text-gray-900 mb-2">API Response:</h4>
                    <pre id="apiResponseText" class="text-sm text-gray-700"></pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        // AI Response Generator (Same as backend)
        function generateAIResponse(userMessage, language) {
            const message = userMessage.toLowerCase();
            
            // Hindi responses
            if (language === 'hi') {
                if (message.includes('‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à') || message.includes('irrigation') || message.includes('‡§™‡§æ‡§®‡•Ä')) {
                    return '‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•Å‡§¨‡§π ‡§Ø‡§æ ‡§∂‡§æ‡§Æ ‡§ï‡§æ ‡§∏‡§Æ‡§Ø ‡§∏‡§¨‡§∏‡•á ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§π‡•à‡•§ ‡§Ö‡§™‡§®‡•Ä ‡§´‡§∏‡§≤ ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§™‡§æ‡§®‡•Ä ‡§¶‡•á‡§Ç - ‡§ó‡•á‡§π‡•Ç‡§Ç ‡§ï‡•ã ‡§∏‡§™‡•ç‡§§‡§æ‡§π ‡§Æ‡•á‡§Ç 2-3 ‡§¨‡§æ‡§∞, ‡§ö‡§æ‡§µ‡§≤ ‡§ï‡•ã ‡§∞‡•ã‡§ú‡§æ‡§®‡§æ ‡§™‡§æ‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è‡•§';
                }
                if (message.includes('‡§ï‡•Ä‡§ü') || message.includes('pest') || message.includes('‡§¨‡•Ä‡§Æ‡§æ‡§∞‡•Ä')) {
                    return '‡§ï‡•Ä‡§ü ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§®‡•Ä‡§Æ ‡§ï‡§æ ‡§§‡•á‡§≤ ‡§Ø‡§æ ‡§ú‡•à‡§µ‡§ø‡§ï ‡§ï‡•Ä‡§ü‡§®‡§æ‡§∂‡§ï ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§®‡§ø‡§Ø‡§Æ‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§™‡§§‡•ç‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§∏‡§Ç‡§ï‡•ç‡§∞‡§Æ‡§ø‡§§ ‡§™‡•å‡§ß‡•ã‡§Ç ‡§ï‡•ã ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§π‡§ü‡§æ ‡§¶‡•á‡§Ç‡•§';
                }
                if (message.includes('‡§ñ‡§æ‡§¶') || message.includes('fertilizer') || message.includes('‡§â‡§∞‡•ç‡§µ‡§∞‡§ï')) {
                    return '‡§ñ‡§æ‡§¶ ‡§°‡§æ‡§≤‡§®‡•á ‡§ï‡§æ ‡§∏‡§π‡•Ä ‡§∏‡§Æ‡§Ø ‡§¨‡•Å‡§µ‡§æ‡§à ‡§ï‡•á 15-20 ‡§¶‡§ø‡§® ‡§¨‡§æ‡§¶ ‡§π‡•à‡•§ NPK ‡§Ö‡§®‡•Å‡§™‡§æ‡§§ 20:20:20 ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§π‡•Ä ‡§ñ‡§æ‡§¶ ‡§°‡§æ‡§≤‡•á‡§Ç‡•§';
                }
                if (message.includes('‡§Æ‡•å‡§∏‡§Æ') || message.includes('weather') || message.includes('‡§¨‡§æ‡§∞‡§ø‡§∂')) {
                    return '‡§Ü‡§ú ‡§ï‡§æ ‡§Æ‡•å‡§∏‡§Æ ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§π‡•à‡•§ ‡§§‡§æ‡§™‡§Æ‡§æ‡§® 28¬∞C ‡§π‡•à‡•§ ‡§Ö‡§ó‡§≤‡•á 2 ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§ï‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ ‡§π‡•à, ‡§á‡§∏‡§≤‡§ø‡§è ‡§Ö‡§™‡§®‡•Ä ‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§';
                }
                if (message.includes('‡§´‡§∏‡§≤') || message.includes('crop') || message.includes('‡§¨‡•Ä‡§ú')) {
                    return '‡§∏‡§π‡•Ä ‡§´‡§∏‡§≤ ‡§ö‡•Å‡§®‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡§æ‡§è‡§Ç‡•§ ‡§∞‡§¨‡•Ä ‡§∏‡•Ä‡§ú‡§® ‡§Æ‡•á‡§Ç ‡§ó‡•á‡§π‡•Ç‡§Ç, ‡§∏‡§∞‡§∏‡•ã‡§Ç, ‡§ö‡§®‡§æ ‡§â‡§ó‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§ñ‡§∞‡•Ä‡§´ ‡§∏‡•Ä‡§ú‡§® ‡§Æ‡•á‡§Ç ‡§ö‡§æ‡§µ‡§≤, ‡§Æ‡§ï‡•ç‡§ï‡§æ, ‡§ï‡§™‡§æ‡§∏ ‡§Ö‡§ö‡•ç‡§õ‡•á ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§π‡•à‡§Ç‡•§';
                }
                if (message.includes('‡§®‡§Æ‡§∏‡•ç‡§§‡•á') || message.includes('hello') || message.includes('hi')) {
                    return '‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡§æ AI ‡§ï‡•É‡§∑‡§ø ‡§∏‡§≤‡§æ‡§π‡§ï‡§æ‡§∞ ‡§π‡•Ç‡§Ç‡•§ ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§´‡§∏‡§≤, ‡§ï‡•Ä‡§ü ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£, ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à, ‡§ñ‡§æ‡§¶ ‡§î‡§∞ ‡§Æ‡•å‡§∏‡§Æ ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§≤‡§æ‡§π ‡§¶‡•á ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç‡•§ ‡§Ü‡§™ ‡§ï‡•ç‡§Ø‡§æ ‡§ú‡§æ‡§®‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?';
                }
                return '‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ø‡§π‡§æ‡§Ç ‡§π‡•Ç‡§Ç‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡•Ä ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§Ø‡§æ ‡§∏‡§µ‡§æ‡§≤ ‡§µ‡§ø‡§∏‡•ç‡§§‡§æ‡§∞ ‡§∏‡•á ‡§¨‡§§‡§æ‡§è‡§Ç‡•§ ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•ã ‡§∏‡§¨‡§∏‡•á ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§∏‡§≤‡§æ‡§π ‡§¶‡•Ç‡§Ç‡§ó‡§æ‡•§';
            }
            
            // English responses
            if (language === 'en') {
                if (message.includes('irrigation') || message.includes('water') || message.includes('watering')) {
                    return 'For irrigation, early morning or evening is the best time. Water according to your crop - wheat needs water 2-3 times a week, rice needs daily watering.';
                }
                if (message.includes('pest') || message.includes('disease') || message.includes('insect')) {
                    return 'For pest control, use neem oil or organic pesticides. Regularly check leaves and remove infected plants immediately.';
                }
                if (message.includes('fertilizer') || message.includes('manure') || message.includes('nutrient')) {
                    return 'The right time to apply fertilizer is 15-20 days after sowing. Use NPK ratio 20:20:20. Apply fertilizer only after soil testing.';
                }
                if (message.includes('weather') || message.includes('rain') || message.includes('temperature')) {
                    return 'Today\'s weather is good. Temperature is 28¬∞C. There is a chance of rain in the next 2 days, so protect your crops.';
                }
                if (message.includes('crop') || message.includes('seed') || message.includes('planting')) {
                    return 'For choosing the right crop, get your soil tested. In Rabi season, you can grow wheat, mustard, gram. In Kharif season, rice, maize, cotton are good options.';
                }
                if (message.includes('hello') || message.includes('hi') || message.includes('namaste')) {
                    return 'Hello! I am your AI agriculture advisor. I can help you with crop advice, pest control, irrigation, fertilizer, and weather information. What would you like to know?';
                }
                return 'I am here to help you. Please describe your problem or question in detail. I will give you the best advice.';
            }
            
            // Punjabi responses
            if (language === 'pa') {
                if (message.includes('‡®∏‡®ø‡©∞‡®ö‡®æ‡®à') || message.includes('‡®™‡®æ‡®£‡©Ä')) {
                    return '‡®∏‡®ø‡©∞‡®ö‡®æ‡®à ‡®≤‡®à ‡®∏‡®µ‡©á‡®∞ ‡®ú‡®æ‡®Ç ‡®∏‡®º‡®æ‡®Æ ‡®¶‡®æ ‡®∏‡®Æ‡®æ‡®Ç ‡®∏‡®≠ ‡®§‡©ã‡®Ç ‡®µ‡®ß‡©Ä‡®Ü ‡®π‡©à‡•§ ‡®Ü‡®™‡®£‡©Ä ‡®´‡®∏‡®≤ ‡®¶‡©á ‡®Ö‡®®‡©Å‡®∏‡®æ‡®∞ ‡®™‡®æ‡®£‡©Ä ‡®¶‡®ø‡®ì - ‡®ï‡®£‡®ï ‡®®‡©Ç‡©∞ ‡®π‡®´‡®º‡®§‡©á ‡®µ‡®ø‡©±‡®ö 2-3 ‡®µ‡®æ‡®∞, ‡®ö‡©å‡®≤‡®æ‡®Ç ‡®®‡©Ç‡©∞ ‡®∞‡©ã‡®ú‡®º‡®æ‡®®‡®æ ‡®™‡®æ‡®£‡©Ä ‡®ö‡®æ‡®π‡©Ä‡®¶‡®æ ‡®π‡©à‡•§';
                }
                if (message.includes('‡®ï‡©Ä‡®ü') || message.includes('‡®∞‡©ã‡®ó')) {
                    return '‡®ï‡©Ä‡®ü ‡®®‡®ø‡®Ø‡©∞‡®§‡®∞‡®£ ‡®≤‡®à ‡®®‡©Ä‡®Æ ‡®¶‡®æ ‡®§‡©á‡®≤ ‡®ú‡®æ‡®Ç ‡®ú‡©à‡®µ‡®ø‡®ï ‡®ï‡©Ä‡®ü‡®®‡®æ‡®∏‡®º‡®ï ‡®¶‡®æ ‡®â‡®™‡®Ø‡©ã‡®ó ‡®ï‡®∞‡©ã‡•§ ‡®®‡®ø‡®Ø‡®Æ‡®ø‡®§ ‡®§‡©å‡®∞ \'‡®§‡©á ‡®™‡©±‡®§‡®ø‡®Ü‡®Ç ‡®¶‡©Ä ‡®ú‡®æ‡®Ç‡®ö ‡®ï‡®∞‡©ã ‡®Ö‡®§‡©á ‡®∏‡©∞‡®ï‡®∞‡®Æ‡®ø‡®§ ‡®™‡©å‡®¶‡®ø‡®Ü‡®Ç ‡®®‡©Ç‡©∞ ‡®§‡©Å‡®∞‡©∞‡®§ ‡®π‡®ü‡®æ ‡®¶‡®ø‡®ì‡•§';
                }
                if (message.includes('‡®∏‡®§ ‡®∏‡©ç‡®∞‡©Ä ‡®Ö‡®ï‡®æ‡®≤') || message.includes('hello') || message.includes('hi')) {
                    return '‡®∏‡®§ ‡®∏‡©ç‡®∞‡©Ä ‡®Ö‡®ï‡®æ‡®≤! ‡®Æ‡©à‡®Ç ‡®§‡©Å‡®π‡®æ‡®°‡®æ AI ‡®ñ‡©á‡®§‡©Ä ‡®∏‡®≤‡®æ‡®π‡®ï‡®æ‡®∞ ‡®π‡®æ‡®Ç‡•§ ‡®Æ‡©à‡®Ç ‡®§‡©Å‡®π‡®æ‡®°‡©Ä ‡®´‡®∏‡®≤, ‡®ï‡©Ä‡®ü ‡®®‡®ø‡®Ø‡©∞‡®§‡®∞‡®£, ‡®∏‡®ø‡©∞‡®ö‡®æ‡®à, ‡®ñ‡®æ‡®¶ ‡®Ö‡®§‡©á ‡®Æ‡©å‡®∏‡®Æ ‡®¨‡®æ‡®∞‡©á ‡®∏‡®≤‡®æ‡®π ‡®¶‡©á ‡®∏‡®ï‡®¶‡®æ ‡®π‡®æ‡®Ç‡•§ ‡®§‡©Å‡®∏‡©Ä‡®Ç ‡®ï‡©Ä ‡®ú‡®æ‡®£‡®®‡®æ ‡®ö‡®æ‡®π‡©Å‡©∞‡®¶‡©á ‡®π‡©ã?';
                }
                return '‡®Æ‡©à‡®Ç ‡®§‡©Å‡®π‡®æ‡®°‡©Ä ‡®Æ‡®¶‡®¶ ‡®ï‡®∞‡®® ‡®≤‡®à ‡®á‡©±‡®•‡©á ‡®π‡®æ‡®Ç‡•§ ‡®ï‡®ø‡®∞‡®™‡®æ ‡®ï‡®∞‡®ï‡©á ‡®Ü‡®™‡®£‡©Ä ‡®∏‡®Æ‡®∏‡®ø‡®Ü ‡®ú‡®æ‡®Ç ‡®∏‡®µ‡®æ‡®≤ ‡®µ‡®ø‡®∏‡®§‡®æ‡®∞ ‡®®‡®æ‡®≤ ‡®¶‡©±‡®∏‡©ã‡•§ ‡®Æ‡©à‡®Ç ‡®§‡©Å‡®π‡®æ‡®®‡©Ç‡©∞ ‡®∏‡®≠ ‡®§‡©ã‡®Ç ‡®µ‡®ß‡©Ä‡®Ü ‡®∏‡®≤‡®æ‡®π ‡®¶‡®µ‡®æ‡®Ç‡®ó‡®æ‡•§';
            }
            
            return 'I am here to help you. Please describe your problem or question in detail.';
        }

        // Quick questions data
        const quickQuestions = {
            hi: [
                '‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à ‡§ï‡§¨ ‡§ï‡§∞‡•á‡§Ç?',
                '‡§ï‡•Ä‡§ü ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£ ‡§ï‡•à‡§∏‡•á ‡§ï‡§∞‡•á‡§Ç?',
                '‡§ñ‡§æ‡§¶ ‡§ï‡§¨ ‡§°‡§æ‡§≤‡•á‡§Ç?',
                '‡§Æ‡•å‡§∏‡§Æ ‡§ï‡•à‡§∏‡§æ ‡§π‡•à?',
                '‡§´‡§∏‡§≤ ‡§ï‡•à‡§∏‡•á ‡§ö‡•Å‡§®‡•á‡§Ç?',
                '‡§®‡§Æ‡§∏‡•ç‡§§‡•á'
            ],
            en: [
                'When to irrigate?',
                'How to control pests?',
                'When to apply fertilizer?',
                'What is the weather?',
                'How to choose crops?',
                'Hello'
            ],
            pa: [
                '‡®∏‡®ø‡©∞‡®ö‡®æ‡®à ‡®ï‡®¶‡©ã‡®Ç ‡®ï‡®∞‡©Ä‡®è?',
                '‡®ï‡©Ä‡®ü ‡®®‡®ø‡®Ø‡©∞‡®§‡®∞‡®£ ‡®ï‡®ø‡®µ‡©á‡®Ç ‡®ï‡®∞‡©Ä‡®è?',
                '‡®ñ‡®æ‡®¶ ‡®ï‡®¶‡©ã‡®Ç ‡®™‡®æ‡®à‡®è?',
                '‡®Æ‡©å‡®∏‡®Æ ‡®ï‡®ø‡®µ‡©á‡®Ç ‡®π‡©à?',
                '‡®´‡®∏‡®≤ ‡®ï‡®ø‡®µ‡©á‡®Ç ‡®ö‡©Å‡®£‡©Ä‡®è?',
                '‡®∏‡®§ ‡®∏‡©ç‡®∞‡©Ä ‡®Ö‡®ï‡®æ‡®≤'
            ]
        };

        // Placeholders for different languages
        const placeholders = {
            hi: '‡§Ö‡§™‡§®‡§æ ‡§∏‡§µ‡§æ‡§≤ ‡§Ø‡§π‡§æ‡§Å ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç...',
            en: 'Type your question here...',
            pa: '‡®Ü‡®™‡®£‡®æ ‡®∏‡®µ‡®æ‡®≤ ‡®á‡©±‡®•‡©á ‡®ü‡®æ‡®à‡®™ ‡®ï‡®∞‡©ã...'
        };

        let messageId = 1;
        let isListening = false;
        let messageCount = 1;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            const messagesContainer = document.getElementById('messagesContainer');
            const messageInput = document.getElementById('messageInput');
            const sendButton = document.getElementById('sendButton');
            const voiceButton = document.getElementById('voiceButton');
            const languageSelect = document.getElementById('languageSelect');
            const quickQuestionsContainer = document.getElementById('quickQuestions');
            const initialTime = document.getElementById('initialTime');
            const currentLang = document.getElementById('currentLang');
            const messageCountEl = document.getElementById('messageCount');

            // Set initial time
            initialTime.textContent = new Date().toLocaleTimeString();

            // Update quick questions and placeholder based on language
            function updateLanguage() {
                const selectedLang = languageSelect.value;
                messageInput.placeholder = placeholders[selectedLang];
                currentLang.textContent = selectedLang === 'hi' ? 'Hindi' : selectedLang === 'en' ? 'English' : 'Punjabi';
                
                quickQuestionsContainer.innerHTML = '';
                quickQuestions[selectedLang].forEach(question => {
                    const button = document.createElement('button');
                    button.textContent = question;
                    button.className = 'px-3 py-1 bg-white border border-gray-300 rounded-full text-sm hover:bg-green-50 hover:border-green-300 transition-colors';
                    button.onclick = () => {
                        messageInput.value = question;
                        sendMessage();
                    };
                    quickQuestionsContainer.appendChild(button);
                });
            }

            // Add message to chat
            function addMessage(text, isUser) {
                messageId++;
                messageCount++;
                messageCountEl.textContent = messageCount;
                
                const messageDiv = document.createElement('div');
                messageDiv.className = `flex ${isUser ? 'justify-end' : 'justify-start'} message-animation`;
                
                const messageContent = document.createElement('div');
                messageContent.className = `max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${
                    isUser ? 'bg-green-500 text-white' : 'bg-gray-100 text-gray-900'
                }`;
                
                const messageText = document.createElement('p');
                messageText.className = 'text-sm';
                messageText.textContent = text;
                
                const messageTime = document.createElement('p');
                messageTime.className = `text-xs mt-1 ${isUser ? 'text-green-100' : 'text-gray-500'}`;
                messageTime.textContent = new Date().toLocaleTimeString();
                
                messageContent.appendChild(messageText);
                messageContent.appendChild(messageTime);
                messageDiv.appendChild(messageContent);
                messagesContainer.appendChild(messageDiv);
                
                // Scroll to bottom
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }

            // Show typing indicator
            function showTypingIndicator() {
                const typingDiv = document.createElement('div');
                typingDiv.className = 'flex justify-start';
                typingDiv.id = 'typingIndicator';
                
                const typingContent = document.createElement('div');
                typingContent.className = 'bg-gray-100 text-gray-900 px-4 py-2 rounded-lg';
                
                const typingSpans = document.createElement('div');
                typingSpans.className = 'typing-indicator';
                typingSpans.innerHTML = '<span></span><span></span><span></span>';
                
                typingContent.appendChild(typingSpans);
                typingDiv.appendChild(typingContent);
                messagesContainer.appendChild(typingDiv);
                
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }

            // Remove typing indicator
            function removeTypingIndicator() {
                const typingIndicator = document.getElementById('typingIndicator');
                if (typingIndicator) {
                    typingIndicator.remove();
                }
            }

            // Send message
            function sendMessage() {
                const message = messageInput.value.trim();
                if (message) {
                    addMessage(message, true);
                    messageInput.value = '';
                    
                    // Show typing indicator
                    showTypingIndicator();
                    
                    // Generate AI response after delay
                    setTimeout(() => {
                        removeTypingIndicator();
                        const aiResponse = generateAIResponse(message, languageSelect.value);
                        addMessage(aiResponse, false);
                    }, 1500);
                }
            }

            // Voice input simulation
            function handleVoiceInput() {
                if (!isListening) {
                    isListening = true;
                    voiceButton.innerHTML = 'üî¥';
                    voiceButton.className = 'px-3 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors';
                    voiceButton.title = 'Stop listening';
                    
                    // Simulate voice recognition
                    setTimeout(() => {
                        const voiceMessage = languageSelect.value === 'hi' ? 
                            '‡§Æ‡•Å‡§ù‡•á ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è' :
                            languageSelect.value === 'pa' ?
                            '‡®Æ‡©à‡®®‡©Ç‡©∞ ‡®∏‡®ø‡©∞‡®ö‡®æ‡®à ‡®¨‡®æ‡®∞‡©á ‡®ú‡®æ‡®£‡®ï‡®æ‡®∞‡©Ä ‡®ö‡®æ‡®π‡©Ä‡®¶‡©Ä ‡®π‡©à' :
                            'I need information about irrigation';
                        
                        messageInput.value = voiceMessage;
                        isListening = false;
                        voiceButton.innerHTML = 'üé§';
                        voiceButton.className = 'px-3 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors';
                        voiceButton.title = 'Start voice input';
                        
                        // Auto send the voice message
                        sendMessage();
                    }, 3000);
                } else {
                    isListening = false;
                    voiceButton.innerHTML = 'üé§';
                    voiceButton.className = 'px-3 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors';
                    voiceButton.title = 'Start voice input';
                }
            }

            // Event listeners
            sendButton.addEventListener('click', sendMessage);
            voiceButton.addEventListener('click', handleVoiceInput);
            languageSelect.addEventListener('change', updateLanguage);
            
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });

            // Initialize language
            updateLanguage();
        });

        // Global function for sample questions
        function askQuestion(question) {
            document.getElementById('messageInput').value = question;
            document.getElementById('sendButton').click();
        }

        // API Test function
        async function testAPI() {
            const message = document.getElementById('apiTestInput').value;
            const language = document.getElementById('apiTestLang').value;
            const responseDiv = document.getElementById('apiResponse');
            const responseText = document.getElementById('apiResponseText');
            
            if (!message) {
                alert('Please enter a test message');
                return;
            }
            
            try {
                const response = await fetch('http://localhost:8000/api/v1/simple-chatbot/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: message,
                        language: language
                    })
                });
                
                const data = await response.json();
                responseText.textContent = JSON.stringify(data, null, 2);
                responseDiv.classList.remove('hidden');
            } catch (error) {
                responseText.textContent = `Error: ${error.message}`;
                responseDiv.classList.remove('hidden');
            }
        }
    </script>
</body>
</html>
